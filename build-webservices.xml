<project name="webservice"  basedir=".">

        <property name="global.path" value="${basedir}"/>
    <!--
       Module specific properties
    -->


    <property file="${global.path}/global-build.properties" />


    <property name="warfilename" value="doms-${ant.project.name}.war"/>

    <property name="srcpack.zip" value="doms-${ant.project.name}-src.zip"/>


    <!-- Global- and module specific libs -->





    <fileset  id="used.global.libs.set" dir="${global.path}/lib">
        <include name="axis-1.4.0.jar"/>
        <include name="javaee-9.0.jar"/>
        <include name="commons-logging-1.0.4.jar"/>
        <include name="sbutil-0.3.4.jar"/>

        <!-- Fedora client -->

        <include name="fedora-client-3.0.jar"/>
        <include name="axis-1.4.0.jar"/>
        <include name="batik-all.jar"/>
        <include name="commons-codec-1.3.jar"/>
        <include name="commons-dbcp-1.2.1.jar"/>
        <include name="commons-discovery-0.2.jar"/>
        <include name="commons-httpclient-3.1-beta1.jar"/>
        <include name="commons-logging-1.1.jar"/>
        <include name="log4j-1.2.15.jar"/>
        <include name="commons-pool-1.2.jar"/>
        <include name="java-getopt-1.0.11.jar"/>
        <include name="jai_codec-1.1.2_01.jar"/>
        <include name="jai_core-1.1.2_01.jar"/>
        <include name="mail-1.3.3_01.jar"/>
        <include name="jaxrpc-1.1.jar"/>
        <include name="jhbasic-2.0_01.jar"/>
        <include name="jrdf-0.3.4.3.jar"/>
        <include name="openrdf-model.jar"/>
        <include name="openrdf-util.jar"/>
        <include name="saaj-1.2.jar"/>
        <include name="saxon.jar"/>
        <include name="slf4j-api-1.5.2.jar"/>
        <include name="slf4j-jdk14-1.5.2.jar"/>
        <include name="sunxacml-1.2.patched.jar"/>
        <include name="trippi-1.3.2-core.jar"/>
        <include name="wsdl4j-1.5.1.jar"/>
        <include name="xercesImpl.jar"/>
        <include name="xml-apis.jar"/>
        <include name="xmlpull-1_1_3_4a.jar"/>
        <include name="xpp3_min-1.1.3.4.K.jar"/>





        <!-- For use in generating a wsdl file -->

        <include name="axis2-java2wsdl-1.3-r562247.jar"/>
        <include name="activation-1.0.2.jar"/>

    </fileset>



    <!--Local libraries-->
    <path id="jars.path" >
        <fileset id="jars.set" dir="lib">
            <include name="**/*.jar"/>
        </fileset>
    </path>



    <path id="used.classpath.path">
        <fileset refid="used.global.libs.set"/>
        <fileset refid="jars.set"/>
        <fileset id="dependencies.set" dir="dependencies">
            <include name="*.jar"/>
        </fileset>
    </path>





    <target name="domsutils">
        <!-- Grab the jar file from that module -->
        <ant dir="${global.path}/domsutils/" antfile="build.xml" target="dist"/>
        <copy todir="dependencies">
            <fileset dir="${global.path}/domsutils/dist/" includes="*.jar"/>
        </copy>
    </target>





    <target name="compile" depends="clean,domsutils"
            description="Compile all production classes, and copy properties to class dir">




        <mkdir dir="classes"/>

        <javac source="1.6" destdir="classes" debug="on"
               encoding="UTF-8">
            <src path="src"/>
            <classpath refid="used.classpath.path"/>
        </javac>
        <copy todir="classes" >
            <fileset dir="src" includes="**/*.properties"/>
                        <fileset dir="src" includes="**/*.xml"/>
            <fileset dir="config"/>
        </copy>

    </target>



    <target name="warfile" depends="compile"
            description="Pack the webdirectory into a warfile ready for deployment">
        <mkdir dir="dist"/>
        <war destfile="dist/${warfilename}"
             webxml="web/WEB-INF/web.xml"
             basedir="web">
            <classes dir="classes"/>

            <lib refid="used.global.libs.set"/>
            <lib refid="jars.set" />
            <lib refid ="dependencies.set"/>
            <webinf dir="web/WEB-INF" excludes="web.xml"/>
        </war>
    </target>


    <target name="clean">
        <delete dir="dist"/>
        <delete dir="classes"/>
        <delete dir="dependencies"/>
        <delete dir="server/build"/>
        <mkdir dir="server/build"/>
    </target>


    <target name="src" depends="clean">
        <mkdir dir="dist"/>

        <zip destfile="dist/${srcpack.zip}">
            <zipfileset prefix="config" dir="${basedir}/config"/>
            <zipfileset prefix="lib" dir="${basedir}/lib"/>
            <zipfileset prefix="src" dir="${basedir}/src"/>
            <zipfileset prefix="test" dir="${basedir}/test"/>
            <zipfileset prefix="web" dir="${basedir}/web"/>
            <zipfileset dir="${basedir}">
             <include name="*.xml"/>
                <include name="*.properties"/>
                <include name="*NOTES*"/>
                <include name="*INSTALL*"/>
                <include name="*LICENSE*"/>
            </zipfileset>
            <zipfileset file="${global.path}/build-webservices.xml"/>
            <zipfileset file="${global.path}/global-build.properties"/>
        </zip>

        

    </target>



</project>









